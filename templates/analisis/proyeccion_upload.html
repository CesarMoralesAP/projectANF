{% extends 'dashboard/base.html' %}
{% load static %}

{% block title %}Subir Proyecci贸n - {{ empresa.nombre }}{% endblock %}

{% block content %}
<div class="content-header">
    <div class="content-title">
        <h2>Subir Proyecci贸n desde Excel</h2>
        <p>{{ empresa.nombre }}</p>
    </div>
</div>

<!-- Card del formulario -->
<div class="form-card card">
    <div class="form-card-header">
        <h3 class="form-card-title">Cargar Archivo Excel</h3>
        <p class="form-card-subtitle">Suba el archivo con los datos de proyecci贸n</p>
    </div>
    <div class="form-card-content">
        <form method="post" enctype="multipart/form-data" class="proyeccion-form">
            {% csrf_token %}
            
            <div class="form-grid">
                <!-- Campo Nombre -->
                <div class="form-group">
                    <label for="{{ form.nombre.id_for_label }}" class="form-label">
                        {{ form.nombre.label }}
                    </label>
                    {{ form.nombre }}
                    {% if form.nombre.errors %}
                        <ul class="errorlist">
                            {% for error in form.nombre.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <!-- Campo Descripci贸n -->
                <div class="form-group" style="grid-column: 1 / -1;">
                    <label for="{{ form.descripcion.id_for_label }}" class="form-label">
                        {{ form.descripcion.label }}
                    </label>
                    {{ form.descripcion }}
                    {% if form.descripcion.errors %}
                        <ul class="errorlist">
                            {% for error in form.descripcion.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <!-- Campo Archivo -->
                <div class="form-group" style="grid-column: 1 / -1;">
                    <label for="{{ form.archivo.id_for_label }}" class="form-label">
                        {{ form.archivo.label }}
                    </label>
                    {{ form.archivo }}
                    {% if form.archivo.help_text %}
                        <p style="margin-top: 0.5rem; font-size: 0.875rem; color: #6b7280;">
                            {{ form.archivo.help_text }}
                        </p>
                    {% endif %}
                    {% if form.archivo.errors %}
                        <ul class="errorlist">
                            {% for error in form.archivo.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>
            </div>

            <!-- Errores generales del formulario -->
            {% if form.non_field_errors %}
                <ul class="errorlist">
                    {% for error in form.non_field_errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}

            <!-- Botones de acci贸n -->
            <div class="form-actions">
                <button type="submit" class="btn btn-primary">
                    <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="16" height="16">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                    </svg>
                    <span>Procesar y Ver Gr谩fico</span>
                </button>
                <a href="{% url 'analisis:proyeccion_metodos' empresa.pk %}" class="btn btn-secondary">Cancelar</a>
            </div>
        </form>
    </div>
</div>

<!-- Informaci贸n sobre el formato del archivo -->
<div class="card" style="margin-top: 2rem; background: #f0fdf4; border-left: 4px solid #10b981;">
    <div class="card-content">
        <h4 style="color: #065f46; margin: 0 0 1rem 0; font-size: 1rem; font-weight: 600;">
             Formato del Archivo Excel
        </h4>
        <div style="color: #047857; font-size: 0.875rem; line-height: 1.6;">
            <p style="margin: 0 0 0.75rem 0;"><strong>El archivo debe contener:</strong></p>
            <ul style="margin: 0; padding-left: 1.5rem;">
                <li><strong>Hoja 1:</strong> "valor incremental" con columnas: Mes, Venta</li>
                <li><strong>Hoja 2:</strong> "valor absoluto" con columnas: Mes, Venta</li>
                <li><strong>Hoja 3:</strong> "minimos cuadrados" con columnas: Mes, Venta</li>
            </ul>
            <p style="margin: 1rem 0 0 0;">
                <strong>Formatos aceptados:</strong> .xlsx, .xls (M谩ximo 5MB)
            </p>
        </div>
    </div>
</div>

<div class="form-actions" style="margin-top: 2rem;">
    <a href="{% url 'analisis:proyeccion_metodos' empresa.pk %}" class="btn btn-secondary">
        <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="16" height="16">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
        </svg>
        <span>Volver</span>
    </a>
</div>
{% endblock %}
