
## ğŸ“‹ CONTEXTO DEL PROYECTO

EstÃ¡s desarrollando un **Sistema de AnÃ¡lisis Financiero** para la Universidad de El Salvador. El sistema permite realizar anÃ¡lisis horizontal y vertical de estados financieros, calcular ratios financieros, hacer proyecciones de ventas y comparar empresas entre sÃ­ y contra benchmarks sectoriales.

**Stack TecnolÃ³gico:**

- Backend: Django 5.x
- Base de Datos: MySQL 8.x
- Frontend: Django Templates + Bootstrap 5
- Lenguaje: Python 3.11+


***

## ğŸ¨ DISEÃ‘O Y UI/UX

**Paleta de Colores:**

- Primary: `#6366F1` (Ãndigo/Violeta - botones principales)
- Background: `#F5F5F7` (Gris claro)
- Cards/Surface: `#FFFFFF`
- Text Primary: `#1F2937` (Gris oscuro)
- Text Secondary: `#6B7280` (Gris medio)
- Borders: `#E5E7EB` (Gris muy claro)
- Success: `#10B981` (Verde)
- Error: `#EF4444` (Rojo)
- Warning: `#F59E0B` (Ãmbar)

**TipografÃ­a:**

- Font-family: 'Inter', system-ui, sans-serif
- TÃ­tulos principales: 24-30px, font-weight: 600
- SubtÃ­tulos: 18-20px, font-weight: 500
- Texto body: 14-16px, font-weight: 400
- Labels: 12-14px, font-weight: 500

**Componentes UI Recurrentes:**

1. **Cards** con bordes sutiles, sombra suave, border-radius: 12px
2. **Botones primarios** con background violeta, texto blanco, hover con opacidad 90%
3. **Botones secundarios** con border, background transparent, hover con background gris claro
4. **Inputs** con border gris, focus con border violeta, padding: 10px 12px
5. **MenÃº lateral** con Ã­conos, texto y highlight en elemento activo
6. **Tablas** con headers con background gris claro, rows con hover effect
7. **Badges/Pills** para estados (sectores, roles) con background suave y texto color

***

## ğŸ—ï¸ ARQUITECTURA Y ESTRUCTURA DEL PROYECTO

### Estructura de Directorios Django

```
projectANF/
â”œâ”€â”€ manage.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ .env
â”œâ”€â”€ venv
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â”‚
â”œâ”€â”€ config/                          # ConfiguraciÃ³n del proyecto
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ settings/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py                  # ConfiguraciÃ³n base
â”‚   â”‚   â”œâ”€â”€ desarrollo.py            # Config desarrollo
â”‚   â”‚   â””â”€â”€ produccion.py            # Config producciÃ³n
â”‚   â”œâ”€â”€ urls.py
â”‚   â”œâ”€â”€ wsgi.py
â”‚   â””â”€â”€ asgi.py
â”‚
â”œâ”€â”€ apps/                            # Todas las apps del proyecto
â”‚   â”‚
â”‚   â”œâ”€â”€ catalogos/                   # MÃ³dulo de catÃ¡logos
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ models.py                # TipoEmpresa, Empresa
â”‚   â”‚   â”œâ”€â”€ views.py
â”‚   â”‚   â”œâ”€â”€ forms.py
â”‚   â”‚   â”œâ”€â”€ urls.py
â”‚   â”‚   â”œâ”€â”€ admin.py
â”‚   â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”‚       â””â”€â”€ catalogos/
â”‚   â”‚           â”œâ”€â”€ sector_lista.html
â”‚   â”‚           â”œâ”€â”€ empresa_lista.html
â”‚   â”‚           â””â”€â”€ empresa_formulario.html
â”‚   â”‚
â”‚   â”œâ”€â”€ estados_financieros/         # MÃ³dulo de estados financieros
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ models.py                # BalanceGeneral, EstadoResultados
â”‚   â”‚   â”œâ”€â”€ views.py
â”‚   â”‚   â”œâ”€â”€ forms.py
â”‚   â”‚   â”œâ”€â”€ urls.py
â”‚   â”‚   â”œâ”€â”€ servicios/               # LÃ³gica de negocio
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ carga_excel.py       # Servicio para carga de Excel
â”‚   â”‚   â”‚   â””â”€â”€ validaciones.py      # Validaciones contables
â”‚   â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”‚       â””â”€â”€ estados_financieros/
â”‚   â”‚           â”œâ”€â”€ balance_general_formulario.html
â”‚   â”‚           â””â”€â”€ estado_resultados_formulario.html
â”‚   â”‚
â”‚   â”œâ”€â”€ analisis/                    # MÃ³dulo de anÃ¡lisis financiero
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ views.py
â”‚   â”‚   â”œâ”€â”€ urls.py
â”‚   â”‚   â”œâ”€â”€ servicios/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ analisis_vertical.py
â”‚   â”‚   â”‚   â”œâ”€â”€ analisis_horizontal.py
â”‚   â”‚   â”‚   â”œâ”€â”€ calculadora_ratios.py
â”‚   â”‚   â”‚   â””â”€â”€ comparador.py
â”‚   â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”‚       â””â”€â”€ analisis/
â”‚   â”‚           â”œâ”€â”€ analisis_vertical.html
â”‚   â”‚           â”œâ”€â”€ analisis_horizontal.html
â”‚   â”‚           â””â”€â”€ ratios_financieros.html
â”‚   â”‚
â”‚   â”œâ”€â”€ proyecciones/                # MÃ³dulo de proyecciÃ³n de ventas
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ models.py
â”‚   â”‚   â”œâ”€â”€ views.py
â”‚   â”‚   â”œâ”€â”€ forms.py
â”‚   â”‚   â”œâ”€â”€ urls.py
â”‚   â”‚   â”œâ”€â”€ servicios/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ minimos_cuadrados.py
â”‚   â”‚   â”‚   â”œâ”€â”€ incremento_porcentual.py
â”‚   â”‚   â”‚   â””â”€â”€ incremento_absoluto.py
â”‚   â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”‚       â””â”€â”€ proyecciones/
â”‚   â”‚           â””â”€â”€ proyeccion_ventas.html
â”‚   â”‚
â”‚   â”œâ”€â”€ graficas/                    # MÃ³dulo de grÃ¡ficas
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ views.py
â”‚   â”‚   â”œâ”€â”€ urls.py
â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”‚       â””â”€â”€ graficas/
â”‚   â”‚           â””â”€â”€ dashboard_graficas.html
â”‚   â”‚
â”‚   â”œâ”€â”€ usuarios/                    # MÃ³dulo de usuarios (opcional)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ models.py                # Usuario, Permiso, AccesoUsuario
â”‚   â”‚   â”œâ”€â”€ views.py
â”‚   â”‚   â”œâ”€â”€ forms.py
â”‚   â”‚   â”œâ”€â”€ urls.py
â”‚   â”‚   â”œâ”€â”€ decoradores.py           # Decoradores de permisos
â”‚   â”‚   â”œâ”€â”€ middleware.py
â”‚   â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”‚       â””â”€â”€ usuarios/
â”‚   â”‚           â”œâ”€â”€ login.html
â”‚   â”‚           â”œâ”€â”€ usuario_lista.html
â”‚   â”‚           â””â”€â”€ configurar_permisos.html
â”‚   â”‚
â”‚   â””â”€â”€ core/                        # Funcionalidades compartidas
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ models.py                # Modelos base abstractos
â”‚       â”œâ”€â”€ mixins.py                # Mixins reutilizables
â”‚       â”œâ”€â”€ utilidades.py            # Funciones auxiliares
â”‚       â”œâ”€â”€ constantes.py            # Constantes del sistema
â”‚       â””â”€â”€ templatetags/            # Template tags personalizados
â”‚           â”œâ”€â”€ __init__.py
â”‚           â””â”€â”€ filtros_personalizados.py
â”‚
â”œâ”€â”€ static/                          # Archivos estÃ¡ticos
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â”œâ”€â”€ base.css                 # Estilos base
â”‚   â”‚   â””â”€â”€ componentes.css          # Componentes reutilizables
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ main.js                  # JavaScript principal
â”‚   â”‚   â””â”€â”€ graficas.js              # LÃ³gica de grÃ¡ficas (Chart.js)
â”‚   â””â”€â”€ img/
â”‚       â””â”€â”€ logo.svg
â”‚
â”œâ”€â”€ media/                           # Archivos subidos
â”‚   â””â”€â”€ uploads/
â”‚       â””â”€â”€ estados_financieros/     # Excel subidos
â”‚
â””â”€â”€ templates/                       # Templates globales
    â”œâ”€â”€ base.html                    # Template base
    â”œâ”€â”€ componentes/                 # Componentes reutilizables
    â”‚   â”œâ”€â”€ alerta.html              # Componente de alertas
    â”‚   â”œâ”€â”€ modal.html               # Componente de modal
    â”‚   â”œâ”€â”€ tabla.html               # Componente de tabla
    â”‚   â”œâ”€â”€ navegacion.html          # MenÃº lateral
    â”‚   â””â”€â”€ header.html              # Header superior
    â”œâ”€â”€ autenticacion/
    â”‚   â””â”€â”€ login.html
    â””â”€â”€ dashboard.html               # Dashboard principal
```


***

## ğŸ“ CONVENCIONES DE CÃ“DIGO

### Nomenclatura (Siempre en EspaÃ±ol)

**Variables y Funciones:** `snake_case`

```python
nombre_empresa = "Banco AgrÃ­cola"
calcular_ratio_liquidez(activo_corriente, pasivo_corriente)
obtener_empresas_por_sector()
```

**Clases:** `PascalCase`

```python
class TipoEmpresa(models.Model):
    pass

class CalculadoraRatios:
    pass

class AnalizadorVertical:
    pass
```

**Constantes:** `SCREAMING_SNAKE_CASE`

```python
MAX_EMPRESAS_COMPARACION = 5
MINIMO_ANIOS_ANALISIS = 3
TIPOS_ANALISIS = ['vertical', 'horizontal', 'ratios']
```

**Archivos Python:** `snake_case.py`

```
calculadora_ratios.py
analisis_vertical.py
carga_excel.py
```

**Carpetas:** `snake_case`

```
estados_financieros/
analisis_financiero/
proyeccion_ventas/
```

**Templates:** `snake_case.html`

```
sector_lista.html
balance_general_formulario.html
analisis_vertical_resultado.html
```

**Modelos de Base de Datos:** `PascalCase` en cÃ³digo, `snake_case` en DB

```python
class TipoEmpresa(models.Model):
    class Meta:
        db_table = 'sector'
```


***

## ğŸ’¾ DISEÃ‘O DE BASE DE DATOS

### Principios de NormalizaciÃ³n

1. **Primera Forma Normal (1FN):** Valores atÃ³micos, sin repeticiÃ³n de grupos
2. **Segunda Forma Normal (2FN):** Dependencia funcional completa de la clave primaria
3. **Tercera Forma Normal (3FN):** Sin dependencias transitivas
4. **Nombres claros y descriptivos** en espaÃ±ol
5. **Usar llaves forÃ¡neas** con `on_delete` apropiado
6. **Ãndices** en campos de bÃºsqueda frecuente
7. **Timestamps** en todas las tablas (created_at, updated_at)

### Modelos Base Abstractos

```python
# apps/core/models.py
from django.db import models

class ModeloBase(models.Model):
    """Modelo abstracto base para todas las entidades"""
    creado_en = models.DateTimeField(auto_now_add=True, verbose_name="Fecha de CreaciÃ³n")
    actualizado_en = models.DateTimeField(auto_now=True, verbose_name="Ãšltima ActualizaciÃ³n")
    activo = models.BooleanField(default=True, verbose_name="Activo")

    class Meta:
        abstract = True
        ordering = ['-creado_en']
```



## Estructura MÃ­nima de Tablas

### I. Tablas de Seguridad y Control de Acceso

**Requisito especial**: Estas tres tablas **NO requieren CRUD manual**. Se llenan mediante Script o Store Procedure con al menos 2 usuarios: un administrador (acceso completo) y uno restringido (sin permisos de eliminaciÃ³n).

#### **`usuario`**
- **PropÃ³sito**: Almacena credenciales de acceso al sistema
- **Atributos**: id_usuario (PK), nom_usuario, clave
- **Ejemplos**: Carlos_Calleja, Alberto_Merino

#### **`opcion_crud`**
- **PropÃ³sito**: Define funcionalidades del sistema disponibles
- **Atributos**: id_opcion (PK), des_opcion, num_form
- **Ejemplos**: CatÃ¡logos, Tipos de Empresa, AnÃ¡lisis Vertical

#### **`acceso_usuario`**
- **PropÃ³sito**: Control granular de permisos por usuario y funcionalidad
- **Atributos**: id_usuario (FK), id_opcion (FK), id_empresa (FK, opcional)
- **FunciÃ³n**: Permite restricciones especÃ­ficas (ej. bloquear eliminaciÃ³n)

---

### II. Tablas Maestras y Configuraciones

Almacenan la estructura organizacional y parÃ¡metros de anÃ¡lisis.

#### **`sector`**
- **PropÃ³sito**: ClasificaciÃ³n sectorial de empresas
- **Atributos**: id_sector (PK), nombre_sector, descripcion
- **Uso**: Base para parÃ¡metros de comparaciÃ³n (ej. sector minerÃ­a)

#### **`empresa`**
- **PropÃ³sito**: Registro de empresas analizadas (mÃ­nimo 4 requeridas)
- **Atributos**: id_empresa (PK), id_sector (FK), nombre_empresa, razon_social, pais
- **Requisito**: Al menos 4 empresas con estados financieros completos

#### **`periodo`**
- **PropÃ³sito**: DefiniciÃ³n temporal para anÃ¡lisis
- **Atributos**: id_periodo (PK), aÃ±o, fecha_inicio, fecha_fin
- **Requisito**: MÃ­nimo 3 aÃ±os de datos por empresa

#### **`tipo_ratio`**
- **PropÃ³sito**: Definiciones de ratios financieros calculables
- **Atributos**: id_tipo_ratio (PK), nombre_ratio, tipo_calculo
- **CategorÃ­as**: Liquidez, Actividad, Endeudamiento, Rentabilidad
- **Ejemplos**: RazÃ³n Circulante, Prueba Ãcida, RotaciÃ³n de Activos

#### **`parametro_sectorial`**
- **PropÃ³sito**: Benchmarks externos por sector
- **Atributos**: id_parametro (PK), id_sector (FK), id_tipo_ratio (FK), valor_benchmark, fuente
- **Ejemplo**: Prueba Ã¡cida = 0.55 para sector minas

---

### III. Tablas de CatÃ¡logos y Estados Financieros

**Principio crÃ­tico**: El catÃ¡logo contable es **especÃ­fico por empresa**, no universal.

#### **`catalogo_cuenta`**
- **PropÃ³sito**: CatÃ¡logo de cuentas contables Ãºnico por empresa
- **Atributos**: id_cuenta (PK), id_empresa (FK), codigo_cuenta, descripcion_cuenta, nivel, tipo_clasificacion
- **CaracterÃ­stica**: Cada empresa define su propio plan de cuentas una sola vez

#### **`requerimiento_ratio`**
- **PropÃ³sito**: Mapeo de cuentas necesarias para calcular cada ratio
- **Atributos**: id_requerimiento (PK), id_tipo_ratio (FK), id_cuenta (FK)
- **FunciÃ³n**: Vincula ratios especÃ­ficos con cuentas del catÃ¡logo

#### **`estado_financiero`**
- **PropÃ³sito**: Cabecera de estados financieros por empresa y periodo
- **Atributos**: id_ef (PK), id_empresa (FK), id_periodo (FK), tipo_estado
- **Tipos**: Balance General, Estado de Resultados
- **Requisito**: 4 Balances + 4 Estados de Resultado mÃ­nimos

#### **`detalle_estado_financiero`**
- **PropÃ³sito**: Valores monetarios de cuentas por periodo
- **Atributos**: id_detalle_ef (PK), id_ef (FK), id_cuenta (FK), valor_monetario
- **Carga**: DigitaciÃ³n manual o importaciÃ³n masiva (Excel)

#### **`resultado_ratio`**
- **PropÃ³sito**: Almacenamiento de ratios calculados y promedios
- **Atributos**: id_resultado (PK), id_empresa (FK), id_periodo (FK), id_tipo_ratio (FK), valor_calculado, promedio_calculado
- **Funcionalidad**: Incluye benchmark interno (promedio entre empresas procesadas)

---

### IV. MÃ³dulo de ProyecciÃ³n de Ventas

Requiere datos mensuales completos y mÃ©todos de proyecciÃ³n estadÃ­stica.

#### **`proyeccion_ventas`**
- **PropÃ³sito**: DefiniciÃ³n de proyecciones realizadas por empresa
- **Atributos**: id_proyeccion (PK), id_empresa (FK), metodo_usado
- **MÃ©todos disponibles**: 
  - MÃ­nimos cuadrados
  - Incremento porcentual
  - Incremento absoluto

#### **`detalle_venta_mensual`**
- **PropÃ³sito**: Datos histÃ³ricos y proyectados de ventas mensuales
- **Atributos**: id_detalle_venta (PK), id_proyeccion (FK), mes, aÃ±o, valor_historico, valor_proyectado
- **Requisito**: 12 meses de datos (11 digitados + 1 calculado automÃ¡ticamente si aplica)
- **Carga**: Entrada manual o importaciÃ³n Excel

---

## ğŸ”§ REGLAS DE DESARROLLO

### 1. **Modularidad Extrema**

âœ… **SIEMPRE busca reutilizar antes de crear**

- Verifica si existe un componente, funciÃ³n o vista similar
- Centraliza lÃ³gica repetitiva en `apps/core/`

âŒ **NO dupliques cÃ³digo**

- No copies y pegues funciones
- No repitas validaciones
- No crees mÃºltiples versiones de lo mismo


### 2. **Componentes Reutilizables**

Crea componentes en `templates/componentes/` que se usen en mÃºltiples vistas:

**Ejemplo: Alertas Reutilizables**

```html
<!-- templates/componentes/alerta.html -->
{% if mensaje %}
<div class="alerta alerta-{{ tipo|default:'info' }}" role="alert">
    <span class="icono">{% if tipo == 'error' %}âš ï¸{% elif tipo == 'success' %}âœ…{% else %}â„¹ï¸{% endif %}</span>
    <span class="texto">{{ mensaje }}</span>
</div>
{% endif %}
```

**Uso:**

```html
{% include 'componentes/alerta.html' with mensaje=mensaje tipo='success' %}
```


### 3. **Servicios de Negocio**

Toda lÃ³gica compleja va en **servicios** (no en views):

```python
# apps/analisis/servicios/calculadora_ratios.py

class CalculadoraRatios:
    """Servicio para calcular todos los ratios financieros"""
    
    @staticmethod
    def calcular_liquidez_corriente(activo_corriente, pasivo_corriente):
        """Calcula la razÃ³n de liquidez corriente"""
        if pasivo_corriente == 0:
            return None
        return round(activo_corriente / pasivo_corriente, 2)
    
    @classmethod
    def calcular_todos_ratios(cls, balance, estado_resultados):
        """Calcula todos los ratios de una empresa"""
        return {
            'liquidez_corriente': cls.calcular_liquidez_corriente(...),
            'prueba_acida': cls.calcular_prueba_acida(...),
            # ... mÃ¡s ratios
        }
```


### 4. **Validaciones Centralizadas**

```python
# apps/estados_financieros/servicios/validaciones.py

class ValidadorEstadoFinanciero:
    """Validaciones para estados financieros"""
    
    @staticmethod
    def validar_ecuacion_contable(activos, pasivos, patrimonio):
        """Valida que Activos = Pasivos + Patrimonio"""
        return abs(activos - (pasivos + patrimonio)) < 0.01  # Tolerancia
    
    @staticmethod
    def validar_anio_consecutivo(empresa, anio):
        """Valida que el aÃ±o sea consecutivo a los existentes"""
        # LÃ³gica de validaciÃ³n
        pass
```


### 5. **Forms con ValidaciÃ³n**

```python
# apps/catalogos/forms.py

class EmpresaForm(forms.ModelForm):
    """Formulario para gestiÃ³n de empresas"""
    
    class Meta:
        model = Empresa
        fields = ['nombre', 'direccion', 'sector']
        widgets = {
            'nombre': forms.TextInput(attrs={
                'class': 'form-control',
                'placeholder': 'Nombre de la empresa'
            }),
        }
    

```


### 6. **Views Basadas en Clases (CBV)**

Usa Class-Based Views de Django para reducir cÃ³digo:

```python
# apps/catalogos/views.py

from django.views.generic import ListView, CreateView, UpdateView, DeleteView
from django.urls import reverse_lazy

class EmpresaListView(ListView):
    model = Empresa
    template_name = 'catalogos/empresa_lista.html'
    context_object_name = 'empresas'
    paginate_by = 10
    
    def get_queryset(self):
        queryset = super().get_queryset()
        tipo = self.request.GET.get('tipo')
        if tipo:
            queryset = queryset.filter(sector_id=tipo)
        return queryset
```


### 7. **Manejo de Errores Elegante**

```python
# apps/estados_financieros/views.py

from django.contrib import messages

def cargar_balance_excel(request):
    try:
        if request.method == 'POST':
            archivo = request.FILES.get('archivo_excel')
            servicio = ServicioCargaExcel()
            resultado = servicio.procesar_balance(archivo)
            
            messages.success(request, 'Balance cargado exitosamente')
            return redirect('estados_financieros:lista_balances')
            
    except ValidationError as e:
        messages.error(request, f'Error de validaciÃ³n: {e.message}')
    except Exception as e:
        messages.error(request, 'Error al procesar el archivo. Verifique el formato.')
        # Log del error para debugging
        logger.error(f'Error en carga de Excel: {str(e)}')
    
    return render(request, 'estados_financieros/cargar_balance.html')
```


### 8. **Queries Optimizadas**

```python
# Usa select_related y prefetch_related para evitar N+1 queries

# âŒ MAL - N+1 queries
empresas = Empresa.objects.all()
for empresa in empresas:
    print(empresa.sector.nombre)  # Query adicional por cada empresa

# âœ… BIEN - Una sola query con JOIN
empresas = Empresa.objects.select_related('sector').all()
for empresa in empresas:
    print(empresa.sector.nombre)  # Sin queries adicionales
```


### 9. **DocumentaciÃ³n en CÃ³digo**

```python


### CSS Base (siguiendo Figma)

```css
/* static/css/base.css */

:root {
    /* Colores segÃºn prototipo Figma */
    --color-primary: #6366F1;
    --color-primary-hover: #4F46E5;
    --color-background: #F5F5F7;
    --color-surface: #FFFFFF;
    --color-text-primary: #1F2937;
    --color-text-secondary: #6B7280;
    --color-border: #E5E7EB;
    --color-success: #10B981;
    --color-error: #EF4444;
    --color-warning: #F59E0B;
    
    /* Espaciados */
    --spacing-xs: 4px;
    --spacing-sm: 8px;
    --spacing-md: 16px;
    --spacing-lg: 24px;
    --spacing-xl: 32px;
    
    /* Border radius */
    --radius-sm: 6px;
    --radius-md: 12px;
    --radius-lg: 16px;
    
    /* Sombras */
    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
}

body {
    font-family: 'Inter', system-ui, -apple-system, sans-serif;
    background-color: var(--color-background);
    color: var(--color-text-primary);
    font-size: 14px;
}

/* Botones */
.btn-primary {
    background-color: var(--color-primary);
    border: none;
    border-radius: var(--radius-sm);
    padding: 10px 20px;
    font-weight: 500;
    transition: all 0.2s;
}

.btn-primary:hover {
    background-color: var(--color-primary-hover);
    transform: translateY(-1px);
}

/* Cards */
.card {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-sm);
    padding: var(--spacing-lg);
    margin-bottom: var(--spacing-md);
}

/* Tablas */
.tabla-moderna {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
}

.tabla-moderna thead {
    background-color: #F9FAFB;
}

.tabla-moderna th {
    padding: 12px 16px;
    text-align: left;
    font-weight: 600;
    font-size: 12px;
    color: var(--color-text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.tabla-moderna tbody tr:hover {
    background-color: #F9FAFB;
}

.tabla-moderna td {
    padding: 12px 16px;
    border-top: 1px solid var(--color-border);
}
```


***

## ğŸ“¦ REQUERIMIENTOS TÃ‰CNICOS ESPECÃFICOS

### Funcionalidades Obligatorias

1. **CatÃ¡logos:**
    - CRUD completo de Tipos de Empresa
    - CRUD completo de Empresas
    - ConfiguraciÃ³n de catÃ¡logo contable flexible por empresa (una sola vez)
    - CRUD de ratios de referencia por sector
2. **Estados Financieros:**
    - Ingreso manual de Balance General (mÃ­nimo 3 aÃ±os)
    - Ingreso manual de Estado de Resultados (mÃ­nimo 3 aÃ±os)
    - Carga masiva desde Excel (Balance y Estado de Resultados)
    - ValidaciÃ³n de ecuaciÃ³n contable: Activos = Pasivos + Patrimonio
    - Plantillas Excel descargables
3. **AnÃ¡lisis Financiero:**
    - AnÃ¡lisis Vertical: CÃ¡lculo de porcentajes sobre totales
    - AnÃ¡lisis Horizontal: ComparaciÃ³n de 2 o mÃ¡s aÃ±os
    - CÃ¡lculo de mÃ­nimo 10 ratios financieros:
        * Liquidez: RazÃ³n corriente, Prueba Ã¡cida, Capital de trabajo
        * Rentabilidad: ROE, ROA, Margen neto
        * Endeudamiento: Deuda/Activo, Cobertura de intereses
        * Actividad: RotaciÃ³n de inventarios, RotaciÃ³n de CxC
    - Comparaciones: Interna, vs Benchmark, vs Promedio del sistema
4. **ProyecciÃ³n de Ventas:**
    - Ingreso de 12 meses histÃ³ricos (manual o Excel)
    - MÃ©todos: MÃ­nimos Cuadrados, Incremento Porcentual, Incremento Absoluto
    - GeneraciÃ³n automÃ¡tica del mes 12 si solo hay 11 meses
    - VisualizaciÃ³n grÃ¡fica de proyecciones
5. **GrÃ¡ficas:**
    - EvoluciÃ³n de al menos 5 ratios en 3 aÃ±os
    - EvoluciÃ³n de cuenta especÃ­fica en periodo definido
    - ExportaciÃ³n de grÃ¡ficas
6. **Seguridad (Opcional - Valor Agregado):**
    - Login con usuario y contraseÃ±a
    - Control de acceso por mÃ³dulo
    - Permisos CRUD por usuario
    - Middleware de autenticaciÃ³n

### Datos de DemostraciÃ³n

**MÃ­nimo 4 empresas:**

- 2 del sector Bancos (ej: Banco AgrÃ­cola)
- 2 del sector Comercio 

**Para cada empresa:**

- 3 Balances Generales (aÃ±os consecutivos: 2020, 2021, 2022)
- 3 Estados de Resultados correspondientes
- CatÃ¡logo contable configurado

**Ratios de referencia:**

- ExtraÃ­dos de fuentes confiables (Almanac of Business and Industrial Financial Ratios, ministerios)
- Al menos 10 ratios con valores benchmark por sector

***
## âš ï¸ ANTI-PATRONES A EVITAR

âŒ **NO hacer:**

1. CÃ³digo duplicado en mÃºltiples archivos
2. LÃ³gica de negocio en views (debe estar en servicios)
3. Queries N+1 sin select_related/prefetch_related
4. Hard-coding de valores (usar constantes o configuraciÃ³n)
5. Mezclar espaÃ±ol e inglÃ©s en nombres
6. Templates monolÃ­ticos (dividir en componentes)
7. Forms sin validaciÃ³n
8. Excepciones genÃ©ricas sin manejo especÃ­fico
9. Commits sin mensajes descriptivos
10. CÃ³digo sin documentaciÃ³n

âœ… **SÃ hacer:**

1. Verificar reutilizaciÃ³n antes de crear
2. Separar responsabilidades (models, views, services, forms)
3. Usar mixins y herencia para comportamiento comÃºn
4. Validar datos en mÃºltiples capas (forms, models, services)
5. Mantener templates pequeÃ±os y componibles
6. Usar context processors para datos globales
7. Implementar logging apropiado
8. Escribir tests para servicios crÃ­ticos
9. Seguir convenciones Django y PEP 8
10. Documentar decisiones importantes

***


## ğŸ”„ ITERACIÃ“N Y MEJORA CONTINUA

DespuÃ©s de cada feature implementado:

1. **Revisar** si se siguieron las convenciones
2. **Refactorizar** cÃ³digo duplicado
3. **Documentar** cambios importantes
***
